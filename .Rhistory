finaltable<- table[!(is.na(table$max_pain)), ]
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!(finaltable$route == "IV") |!(finaltable$route == "IV DRIP") , ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
View(finaltable)
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
table<- left_join(cohort,opioid, "hadm_id")
table$subject_id<- table$subject_id.x
table$subject_id.y<- NULL
table$subject_id.x<- NULL
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
finaltable<- table[!(is.na(table$max_pain)), ]
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!(finaltable$route == "IV") |!(finaltable$route == "IV DRIP") , ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
table<- left_join(cohort,opioid, "hadm_id")
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
finaltable<- table[!(is.na(table$max_pain)), ]
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!(finaltable$route == "IV") |!(finaltable$route == "IV DRIP") , ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
View(finaltable)
sum(is.na(table$med.pain))
sum(is.na(table$formulary_drug_cd))
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,opioid, "hadm_id")
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
sum(is.na(table$formulary_drug_cd))
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!(finaltable$route == "IV") |!(finaltable$route == "IV DRIP") , ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
write.csv(finaltable,file = "finaltable.csv")
View(oralopioid_nodup)
oralopioid<- finaltable[!(finaltable$route == "IV") |!(finaltable$route == "IV DRIP"), ]
oralopioid<- finaltable[!((finaltable$route == "IV") |(finaltable$route == "IV DRIP")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
View(oralopioid_nodup)
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
oralopioid<- finaltable[!((finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
View(oralopioid)
View(oralopioid_nodup)
View(IVtable_nodup)
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,opioid, "hadm_id")
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
sum(is.na(finaltable$formulary_drug_cd))
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!((finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
library(tidyverse)
library(tidyverse)
library(readr)
finaltable <- read_csv("~/SSmimic/finaltable.csv")
View(finaltable)
sum(is.na(finaltable$admityear))
sum(is.na(finaltable$route))
library(tidyverse)
a<- filter(finaltable, finaltable$admityear == "2001")
View(a)
a<- filter(finaltable, finaltable$admityear == "2002")
View(a)
finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)] <- 0
a<- filter(finaltable, finaltable$admityear == "2002")
View(a)
finaltable$formulary_drug_cd[!is.na(finaltable$formulary_drug_cd)] <- 1
a<- filter(finaltable, finaltable$admityear == "2002")
finaltable$formulary_drug_cd[!(is.na(finaltable$formulary_drug_cd))] <- 1
a<- filter(finaltable, finaltable$admityear == "2002")
ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)], 0, 1)
a<- filter(finaltable, finaltable$admityear == "2002")
View(finaltable)
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,opioid, "hadm_id")
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
sum(is.na(finaltable$formulary_drug_cd))
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!((finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)], 0, 1)
finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)] <- 1
a<- filter(finaltable, finaltable$admityear == "2002")
ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)], 0, 1)
a<- filter(finaltable, finaltable$admityear == "2002")
View(a)
ifelse(is.na(finaltable$formulary_drug_cd), 0, 1)
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,opioid, "hadm_id")
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
sum(is.na(finaltable$formulary_drug_cd))
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!((finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
ifelse(is.na(finaltable$formulary_drug_cd), 0, 1)
a<- filter(finaltable, finaltable$admityear == "2002")
View(a)
View(a)
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,opioid, "hadm_id")
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
sum(is.na(finaltable$formulary_drug_cd))
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!((finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
finaltable<- ifelse(is.na(finaltable$formulary_drug_cd), 0, 1)
a<- filter(finaltable, finaltable$admityear == "2002")
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,opioid, "hadm_id")
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
sum(is.na(finaltable$formulary_drug_cd))
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finaltable[(finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- finaltable[!((finaltable$route == "IV") |(finaltable$route == "IV DRIP")|(finaltable$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finaltable,file = "finaltable.csv")
finaltable1<- ifelse(is.na(finaltable$formulary_drug_cd), 0, 1)
a<- filter(finaltable1, finaltable1$admityear == "2002")
View(cohort)
View(finaltable)
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
finalopioid<- ifelse(is.na(opioid$formulary_drug_cd), 0, 1)
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finalopioid[(finalopioid$route == "IV") |(finalopioid$route == "IV DRIP")|(finalopioid$route == "IVPCA") , ]
IVtable<- finalopioid[(finalopioid$route == "IV") |(finalopioid$route == "IV DRIP")|(finalopioid$route == "IVPCA") , ]
finalopioid<- ifelse(is.na(opioid$formulary_drug_cd), 0, 1)
View(Fentanyl)
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
#finalopioid<- ifelse(is.na(opioid$formulary_drug_cd), 0, 1)
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- finalopioid[(finalopioid$route == "IV") |(finalopioid$route == "IV DRIP")|(finalopioid$route == "IVPCA") , ]
IVtable<- opioid[(opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
#finalopioid<- ifelse(is.na(opioid$formulary_drug_cd), 0, 1)
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- opioid[(opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- opioid[!((opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(finalopioid,file = "finalopioid.csv")
write.csv(IVtable_nodup,file = "IVtable")
write.csv(oralopioid_nodup,file = "oralopioid.csv")
rite.csv(IVtable_nodup,file = "IVtable")
write.csv(IVtable_nodup,file = "IVtable")
write.csv(oralopioid_nodup,file = "oralopioid.csv")
write.csv(IVtable_nodup,file = "IVtablend")
write.csv(oralopioid_nodup,file = "oralopioidnd.csv")
IVtable_nodup<- ifelse(is.na(IVtable$formulary_drug_cd), 0, 1)
IVtable_nodup[ifelse(is.na(IVtable$formulary_drug_cd), 0, 1)
]
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- opioid[(opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- opioid[!((opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
IVtable_nodup[ifelse(is.na(IVtable$formulary_drug_cd), 0, 1)]
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(IVtable_nodup,file = "IVtablend")
write.csv(oralopioid_nodup,file = "oralopioidnd.csv")
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- opioid[(opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- opioid[!((opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(IVtable_nodup,file = "IVtablend")
write.csv(oralopioid_nodup,file = "oralopioidnd.csv")
library(tidyverse)
library(readr)
opioid <- read_csv("~/SSmimic/Medication/opioid.csv")
library(tidyverse)
library(readr)
IVopioid <- read_csv("~/SSmimic/Medication/IVtablend.csv")
IVopioid <- read_csv("~/SSmimic/Medication/IVtablend.csv")
write.csv(IVtable_nodup,file = "IVtablend")
library(tidyverse)
library(readr)
IVopioid <- read_csv("~/SSmimic/Medication/IVtablend.csv")
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- opioid[(opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- opioid[!((opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(IVtable_nodup,file = "IVtable_nodup")
write.csv(oralopioid_nodup,file = "oralopioid_nodup.csv")
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- opioid[(opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- opioid[!((opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
write.csv(IVtable_nodup,file = "IVtable_nodup")
write.csv(oralopioid_nodup,file = "oralopioid_nodup.csv")
library(readr)
Fentanyl <- read_csv("~/SSmimic/Medication/Fentanyl.csv")
Hydromorphone <- read_csv("~/SSmimic/Medication/Hydromorphone.csv")
Morphine <- read_csv("~/SSmimic/Medication/Morphine.csv")
Oxycodone <- read_csv("~/SSmimic/Medication/Oxycodone.csv")
Percocet <- read_csv("~/SSmimic/Medication/Percocet.csv")
Hydrocodone <- read_csv("~/SSmimic/Medication/Hydrocodone.csv")
#create tables with no duplicated hadm_id
library(dplyr)
Fent<- Fentanyl %>% distinct(hadm_id, .keep_all = TRUE)
Hydrom<- Hydromorphone %>% distinct(hadm_id, .keep_all = TRUE)
Morph<- Morphine %>% distinct(hadm_id, .keep_all = TRUE)
Oxycod<- Oxycodone %>% distinct(hadm_id, .keep_all = TRUE)
Perco <- Percocet %>% distinct(hadm_id, .keep_all = TRUE)
Hydrocod<- Hydrocodone %>% distinct(hadm_id, .keep_all = TRUE)
#create combined opioid medication table
opioid <- rbind(Fent,Hydrom, Morph, Oxycod, Perco, Hydrocod)
opioid_nohadmid<-  opioid %>% distinct(hadm_id, .keep_all = TRUE)
#create csv
write.csv(opioid, file = "opioid.csv")
#create  table with only IV drug presiscriptions and remove duplicated hadm_id
IVtable<- opioid[(opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA") , ]
IVtable_nodup<-  IVtable %>% distinct(hadm_id, .keep_all = TRUE)
write.csv(IVtable_nodup,file = "IVtable_nodup.csv")
#create  table with NO IV drug presiscriptions and remove duplicated hadm_id
oralopioid<- opioid[!((opioid$route == "IV") |(opioid$route == "IV DRIP")|(opioid$route == "IVPCA")), ]
oralopioid_nodup<-  oralopioid %>% distinct(hadm_id, .keep_all = TRUE)
write.csv(oralopioid_nodup,file = "oralopioid_nodup.csv")
#write csv - will still have duplicated hadm_id, (if one patients recieved multiple opioids)
library(tidyverse)
library(readr)
IVopioid <- read_csv("~/SSmimic/Medication/IVtablend.csv")
IVopioid <- read_csv("~/SSmimic/Medication/IVtable_nodup.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
finaltable<- left_join(cohort,IVopioid, "hadm_id")
sum(is.na(finaltable$formulary_drug_cd))
finaltable[finaltable == NA] <- 0
library(tidyverse)
library(readr)
IVopioid <- read_csv("~/SSmimic/Medication/IVtable_nodup.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,IVopioid, "hadm_id")
#Replacing NA to 0:
finaltable[finaltable$formulary_drug_cd == NA] <- 0
finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)] <- 0
View(finaltable)
finaltable$formulary_drug_cd[!is.na(finaltable$formulary_drug_cd)] <- 1
View(finaltable)
library(tidyverse)
library(readr)
IVopioid <- read_csv("~/SSmimic/Medication/IVtable_nodup.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,IVopioid, "hadm_id")
#Replacing NA to 0:
ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)],0,1)
library(tidyverse)
library(readr)
IVopioid <- read_csv("~/SSmimic/Medication/IVtable_nodup.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,IVopioid, "hadm_id")
#Replacing NA to 0:
ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)],0,1)
#finaltable$formulary_drug_cd[!is.na(finaltable$formulary_drug_cd)] <- 1
write.csv(finaltable, file = "finaltable.csv")
View(finaltable)
View(finaltable)
#the table now has more that 120k observations -  patients without reported pain scores are being added to the table, therefore will remove ll rows where median or max reported pain is 0
sum(is.na(finaltable$formulary_drug_cd))
View(finaltable)
finaltable<- left_join(cohort,IVopioid, "hadm_id")
finaltable$formulary_drug_cd<- ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)],0,1)
finaltable<- left_join(cohort,IVopioid, "hadm_id")
finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)] <- 0
finaltable$formulary_drug_cd<- mutate(!finaltable$formulary_drug_cd == "0" <- 1)
finaltable$formulary_drug_cd<- mutate(!(finaltable$formulary_drug_cd = "0") == 1)
finaltable<- left_join(cohort,IVopioid, "hadm_id")
finaltable$formulary_drug_cd<- ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)],0,1)
finaltable<- ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)],0,1)
finaltable<- left_join(cohort,IVopioid, "hadm_id")
ifelse(finaltable$formulary_drug_cd[is.na(finaltable$formulary_drug_cd)],0,1)
finaltable<- left_join(cohort,IVopioid, "hadm_id")
ifelse(is.na(finaltable$formulary_drug_cd),0,1)
finaltable<- left_join(cohort,IVopioid, "hadm_id")
finaltable$formulary_drug_cd<- ifelse(is.na(finaltable$formulary_drug_cd),0,1)
View(finaltable)
library(tidyverse)
library(readr)
IVopioid <- read_csv("~/SSmimic/Medication/IVtable_nodup.csv")
cohort <- read_csv("~/SSmimic/Cohort/cohort.csv")
#merger the tables to ease analysis
finaltable<- left_join(cohort,IVopioid, "hadm_id")
#Replacing NA to 0 and receiving an IV opioid to 1:
finaltable$formulary_drug_cd<- ifelse(is.na(finaltable$formulary_drug_cd),0,1)
#write csv final table: cohort plus IV opioids woth no duplicated hadm_id's
write.csv(finaltable, file = "finaltable.csv")
