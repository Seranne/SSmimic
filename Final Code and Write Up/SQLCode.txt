-- Materialized View: ptdetails 

CREATE MATERIALIZED VIEW ptdetails AS (
select admissions.subject_id, admissions.hadm_id, icustay_detail.icustay_id, icustay_detail.age,
    icustay_detail.gender, admissions.ethnicity, admissions.marital_status, admissions.insurance, 
    icustay_detail.los_hospital, icustay_detail.los_icu, diagnoses_icd.icd9_code
        from admissions
inner join icustay_detail ON admissions.hadm_id = icustay_detail.hadm_id
    inner join diagnoses_icd ON admissions.hadm_id = diagnoses_icd.hadm_id
where diagnoses_icd.icd9_code not like '304%' and diagnoses_icd.icd9_code not like '305%'
    )

Q1 - In identifying pain scores, look at the list of item IDs with pain in them, do we want to include anything else? 
Q2 - Shouldn't we be working with mean pain scores? it's coded also like that - to filter patients by those for whom we have mean and max pain scores
Q3 - Who made icustay detail? How did they calculate age? We don't have the sql code for that and our code won't run because of it 
DO - Make comprehensive list of Opioid meds (for e.g. Methadone AND Methadone HCL.) Include even the medication which did not show results. 
DO - Transfer Med SQL to SQLCode.txt

